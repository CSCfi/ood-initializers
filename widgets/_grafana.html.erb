<% if CSCGrafana.enabled -%>
  <script>
    (function() {
          const grafana_style = document.createElement('style');
          grafana_style.textContent = `
            .grafana-container {
                  display: flex;
                  flex-wrap: wrap;
            }
            .grafana-iframe {
                  flex-basis: 50%;
                  flex-grow: 1;
                  height: 300px;
            }
          `;
          document.head.appendChild(grafana_style);
        })();
  </script>
  <%= render :layout => 'widgets/container', :locals => {:title => "Resource usage", :class => "grafana-container" } do %>
    <% CSCGrafana.panels.each do |panel| -%>
      <iframe class="grafana-iframe" src="<%= CSCGrafana.grafana_url -%>?orgId=1&refresh=30s&from=now-<%= CSCGrafana.time_range -%>&to=now&theme=light&panelId=<%= panel -%>" frameborder="0" sandbox="allow-same-origin allow-scripts"></iframe>
    <% end -%>
  <% end %>
  <%= render :partial => 'widgets/shared_style' %>
<% end %>
